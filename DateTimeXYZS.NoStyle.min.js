/**
 * Created by 小宇专属 on 2017/5/23 0023.
 */
"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},DateTimeXYZS;!function(){DateTimeXYZS=function(e){var t;if("string"==typeof e)t=document.getElementById(e);else{if("object"!=(void 0===e?"undefined":_typeof(e))||!e.tagName)return;t=e}t||alert("日期控件创建失败！"),t.style.cursor="pointer";var a,i,n,o,d,m,l,s,c,r,u,h,T,p,D,f,y,v,C,g=this,b=t.scrollWidth>=150?t.scrollWidth:150,M=(t.scrollHeight,t.parentNode),N=document.createElement("DIV"),Y=document.createElement("DIV"),E=document.createElement("DIV"),L=document.createElement("DIV"),I=function(e){e||(e=new Date),g.dateTime=e,g.dateTimeYear=e.getFullYear(),g.dateTimeMonth=e.getMonth()+1,g.dateTimeDate=e.getDate(),g.dateTimeWeek=g.getWeekNumber(g.dateTimeYear,g.dateTimeMonth,g.dateTimeDate),g.dateTimeDay=e.getDay(),m.value=g.dateTimeYear,r.value=g.dateTimeMonth,p.value=g.dateTimeDate,f.innerHTML=g.formatDate(g.dateTime,"www")+"，第"+g.dateTimeWeek+"周"},k={DateTime:"DateTime",Content:"Content",YearChoice:"YearChoice",MonthChoice:"MonthChoice",DateChoice:"DateChoice"},x=function e(a){n=g.divDateTime.offsetHeight,a||(a=k.Content);var i=function(e){e.className+=" dateTimeDivAssembly",e.style.width=b-22+"px",e.style.padding="5px",e.style.minWidth="128px"},C=function(e){e.style.cursor="pointer",e.className+=" dateTimeBtn"},M=function(e){e.className+=" dateTimeText",e.readOnly=!0},x=function(e){for(var t=0;t<e.childNodes.length;t++)e.removeChild(e.childNodes[t])},w={Year:"Year",Month:"Month",Date:"Date"},H=function e(t,a){var i=document.createElement("TABLE");if(i.className="dateTimeTable",i.style.minWidth="150px",i.style.height="150px",i.style.margin="auto",t==w.Year){i.className+=" dateTimeTableYear";for(var n=0;n<3;n++){for(var o=document.createElement("tr"),d=0;d<4;d++){var m=document.createElement("td");m.width=b/4+"px",m.onmousemove=function(e){this.className="tbOnmousemove"},m.onmouseout=function(e){this.className=""},a=a||g.dateTimeYear,0==n&&0==d?(m.innerHTML="◀",m.onclick=function(){x(Y),Y.appendChild(e(w.Year,a-8)),g.divDateTime.appendChild(Y)}):2==n&&3==d?(m.innerHTML="▶",m.onclick=function(){x(Y),Y.appendChild(e(w.Year,a+8)),g.divDateTime.appendChild(Y)}):(m.innerHTML=a-(5-4*n-d),m.setAttribute("Year",a-(5-4*n-d)),a-(5-4*n-d)==g.dateTimeYear&&(m.className="tdSelected",m.onmousemove=null,m.onmouseout=null),m.onclick=function(){g.dateTime.setFullYear(this.getAttribute("Year")),I(g.dateTime),A(k.Content)}),o.appendChild(m)}i.appendChild(o)}}else if(t==w.Month){i.className+=" dateTimeTableMonth";for(var n=0;n<4;n++){for(var o=document.createElement("tr"),d=0;d<3;d++){var m=document.createElement("td");m.width=b/3+"px",m.onmousemove=function(e){this.className="tbOnmousemove"},m.onmouseout=function(e){this.className=""},m.innerHTML=g.MonthList[3*n+d],m.setAttribute("Month",3*n+d),3*n+d+1==g.dateTimeMonth&&(m.className="tdSelected",m.onmousemove=null,m.onmouseout=null),m.onclick=function(){g.dateTime.setMonth(this.getAttribute("Month")),I(g.dateTime),A(k.Content)},o.appendChild(m)}i.appendChild(o)}}else if(t==w.Date){i.className+=" dateTimeTableDate";for(var l=g.getMonthDays(g.dateTimeYear,g.dateTimeMonth-1),s=new Date(g.dateTimeYear,g.dateTimeMonth-1,1).getDay(),c=document.createElement("thead"),o=document.createElement("tr"),r=0;r<7;r++){var u=document.createElement("th");u.width=b/7+"px",u.innerHTML=g.WeekList[r],o.appendChild(u)}c.appendChild(o),i.appendChild(c);for(var h=document.createElement("tbody"),T=parseInt((l+s)%7>0?(l+s)/7+1:(l+s)/7),n=0;n<T;n++){for(var o=document.createElement("tr"),d=0;d<7;d++){var m=document.createElement("td");m.onmousemove=function(e){this.className="tbOnmousemove"},m.onmouseout=function(e){this.className=""},7*n+d-s>-1&&7*n+d-s<l?(m.innerHTML=7*n+d-s+1,m.setAttribute("Data",7*n+d-s+1),7*n+d-s+1==g.dateTimeDate&&(m.className="tdSelected",m.onmousemove=null,m.onmouseout=null),m.onclick=function(){g.dateTime.setDate(this.getAttribute("Data")),I(g.dateTime),A(k.Content)}):(m.innerHTML=" ",m.onmousemove=null,m.onmouseout=null),o.appendChild(m)}h.appendChild(o)}i.appendChild(h)}return i};if(a==k.DateTime)x(g.divDateTime),g.divDateTime.className="dateTimeDivContainerPublic dateTimeDivDateTime",g.divDateTime.style.width=b+"px",g.divDateTime.style.minWidth="150px",g.divDateTime.style.display="none",g.divDateTime.style.zIndex=88888888,g.divDateTime.onclick=function(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0},g.divDateTime.appendChild(N);else if(a==k.Content){x(N),N.className="dateTimeDivContainerPublic dateTimeDivContent",o=document.createElement("DIV"),o.className="dateTimeDivYear",i(o),d=document.createElement("INPUT"),d.className="dateTimeBtnYearLeft btnLeftSwitch",d.setAttribute("type","button"),d.value="◀",C(d),d.onclick=function(){g.dateTime.setFullYear(g.dateTimeYear-1),I(g.dateTime)},o.appendChild(d),m=document.createElement("INPUT"),m.className="dateTimeTextYear",M(m),m.onclick=function(){e(k.YearChoice),A(k.YearChoice)},o.appendChild(m),l=document.createElement("INPUT"),l.className="dateTimeBtnYearRight btnRightSwitch",l.setAttribute("type","button"),l.value="▶",C(l),l.onclick=function(){g.dateTime.setFullYear(g.dateTimeYear+1),I(g.dateTime)},o.appendChild(l);var P=document.createElement("LEBEL");P.className="dateTimeLebel",P.innerHTML="年",P.style.marginLeft="7px",o.appendChild(P),N.appendChild(o),s=document.createElement("DIV"),s.className="dateTimeDivMonth",i(s),c=document.createElement("INPUT"),c.className="dateTimeBtnMonthLeft btnLeftSwitch",c.setAttribute("type","button"),c.value="◀",C(c),c.onclick=function(){g.dateTime.setMonth(g.dateTimeMonth-2),I(g.dateTime)},s.appendChild(c),r=document.createElement("INPUT"),r.className="dateTimeTextMonth",M(r),r.onclick=function(){e(k.MonthChoice),A(k.MonthChoice)},r.onmousemove=function(){g.divDateTime.style.display=""},s.appendChild(r),u=document.createElement("INPUT"),u.className="dateTimeBtnMonthRight btnRightSwitch",u.setAttribute("type","button"),u.value="▶",C(u),u.onclick=function(){g.dateTime.setMonth(g.dateTimeMonth),I(g.dateTime)},s.appendChild(u);var S=document.createElement("LEBEL");S.className="dateTimeLebel",S.innerHTML="月",S.style.marginLeft="7px",s.appendChild(S),N.appendChild(s),h=document.createElement("DIV"),h.className="dateTimeDivDate",i(h),T=document.createElement("INPUT"),T.className="dateTimeBtnDateLeft btnLeftSwitch",T.setAttribute("type","button"),T.value="◀",C(T),T.onclick=function(){g.dateTime.setDate(g.dateTimeDate-1),I(g.dateTime)},h.appendChild(T),p=document.createElement("INPUT"),p.className="dateTimeTextDate",M(p),p.onclick=function(){e(k.DateChoice),A(k.DateChoice)},h.appendChild(p),D=document.createElement("INPUT"),D.className="dateTimeBtnDateRight btnRightSwitch",D.setAttribute("type","button"),D.value="▶",C(D),D.onclick=function(){g.dateTime.setDate(g.dateTimeDate+1),I(g.dateTime)},h.appendChild(D);var B=document.createElement("LEBEL");B.className="dateTimeLebel",B.innerHTML="日",B.style.marginLeft="7px",h.appendChild(B),N.appendChild(h),f=document.createElement("DIV"),f.className="dateTimeDivInformation",i(f),N.appendChild(f);var _=document.createElement("DIV");_.className="dateTimeDivBtn",i(_),y=document.createElement("INPUT"),y.className="dateTimeBtnToday",y.setAttribute("type","button"),y.value="今天",C(y),y.style.float="left",y.onclick=function(){I()},_.appendChild(y),v=document.createElement("INPUT"),v.className="dateTimeBtnOk",v.setAttribute("type","button"),v.value="确定",C(v),v.style.float="right",v.onclick=function(){t.innerHTML=g.formatDate(g.dateTime,g._dateFormat),t.setAttribute("dateTimeYear",g.dateTime.getFullYear()),t.setAttribute("dateTimeMonth",g.dateTime.getMonth()),t.setAttribute("dateTimeDate",g.dateTime.getDate()),g.divDateTime.style.display="none",g.Callback(g.dateTime)},_.appendChild(v),N.appendChild(_)}else a==k.YearChoice?(x(Y),Y.className="dateTimeDivContainerPublic dateTimeDivYearChoice",Y.appendChild(H(w.Year)),g.divDateTime.appendChild(Y)):a==k.MonthChoice?(x(E),E.className="dateTimeDivContainerPublic dateTimeDivMonthChoice",E.appendChild(H(w.Month)),g.divDateTime.appendChild(E)):a==k.DateChoice&&(x(L),L.className="dateTimeDivContainerPublic dateTimeDivDateChoice",L.appendChild(H(w.Date)),g.divDateTime.appendChild(L))},A=function(e){e||(e=k.Content),N.style.display=e==k.Content?"":"none",Y.style.display=e==k.YearChoice?"":"none",E.style.display=e==k.MonthChoice?"":"none",L.style.display=e==k.DateChoice?"":"none"},w=function(){s.style.display=g._isMonth?"":"none",h.style.display=g._isDate?"":"none",f.style.display=g._isDate?"":"none",y.value=g._isMonth?g._isDate?"今天":"本月":"今年",g.divDateTime.style.Height=g._isMonth?g._isDate?150:90:60},H=function(e,t){var a,i,n=function(){var t=parseInt(e.style.height);t>=i?(clearInterval(a),e.style.height=""):(t+=5,e.style.height=t+"px")},o=function(){var t=parseInt(e.style.height);t<=0?(clearInterval(a),e.style.display="none"):(t--,e.style.height=t+"px")};t?a=setInterval(o,1):(e.style.height="",i=e.offsetHeight,e.style.height="1px",a=setInterval(n,1))};this._isMonth=!0,this._isDate=!0,this.Callback,this._dateFormat="yyyy-MM-dd",this.divDateTime=document.createElement("DIV"),this.dateTime,this.dateTimeYear,this.dateTimeMonth,this.dateTimeDate,this.dateTimeWeek,this.dateTimeDay,this.WeekList=["日","一","二","三","四","五","六"],this.MonthList=["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],this.formatDate=function(e,t){e=void 0==e?new Date:e,e="number"==typeof e?new Date(e):e,t=t||"yyyy-MM-dd HH:mm:ss";var a={y:e.getFullYear(),M:e.getMonth()+1,d:e.getDate(),q:Math.floor((e.getMonth()+3)/3),w:e.getDay(),H:e.getHours(),h:e.getHours()%12==0?12:e.getHours()%12,m:e.getMinutes(),s:e.getSeconds(),S:e.getMilliseconds()};for(var i in a)t=t.replace(new RegExp(i+"+","g"),function(e){var t=a[i]+"";if("w"==i)return(e.length>2?"星期":"周")+g.WeekList[t];for(var n=0,o=t.length;n<e.length-o;n++)t="0"+t;return 1==e.length?t:t.substring(t.length-e.length)});return t},this.isLeapYear=function(e){return e%400==0||e%4==0&&e%100!=0},this.getMonthDays=function(e,t){return[31,null,31,30,31,30,31,31,30,31,30,31][t]||(this.isLeapYear(e)?29:28)},this.getWeekNumber=function(e,t,a){for(var i=new Date(e,0,1).getDay()+a,n=0;n<t-1;n++)i+=this.getMonthDays(e,n);return parseInt(i/7)+(i%7>0?1:0)},this.DateTimeLoad=function(e,a){e=e||new Date,I(e),A(),w(),t.innerHTML=g.formatDate(g.dateTime,g._dateFormat),t.setAttribute("dateTimeYear",g.dateTime.getFullYear()),t.setAttribute("dateTimeMonth",g.dateTime.getMonth()),t.setAttribute("dateTimeDate",g.dateTime.getDate()),g.Callback=a||function(e){}},t.onclick=function(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0,g.divDateTime.style.display="",A(k.Content);var n=this.getAttribute("dateTimeYear"),o=this.getAttribute("dateTimeMonth"),d=this.getAttribute("dateTimeDate");n&&I(new Date(parseInt(n),parseInt(o),parseInt(d))),a=t.offsetTop,i=t.offsetLeft,g.divDateTime.style.top=a+"px",g.divDateTime.style.left=i+"px",H(g.divDateTime,""),C=document.onclick,document.onclick=function(){g.divDateTime.style.display="none",document.onclick=C}},M.appendChild(g.divDateTime),x(k.DateTime),x(k.Content),this.DateTimeLoad()},DateTimeXYZS.prototype={constructor:DateTimeXYZS,setDateFormat:function(e){return!!/(^y{1,4}-M{1,2}-d{1,2}$)|(^y{1,4}-M{1,2}$)|(^y{1,4}$)/.test(e)&&(this._isMonth=e.indexOf("M")>0,this._isDate=e.indexOf("d")>0,this._dateFormat=e,this.DateTimeLoad(this.dateTime,this.Callback),!0)}}}();